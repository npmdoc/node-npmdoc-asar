<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/electron/asar">asar (v0.13.0)</a>
</h1>
<h4>Creating Electron app packages</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.asar">module asar</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.asar.createPackage">
            function <span class="apidocSignatureSpan">asar.</span>createPackage
            <span class="apidocSignatureSpan">(src, dest, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.asar.createPackageFromFiles">
            function <span class="apidocSignatureSpan">asar.</span>createPackageFromFiles
            <span class="apidocSignatureSpan">(src, dest, filenames, metadata, options, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.asar.createPackageWithOptions">
            function <span class="apidocSignatureSpan">asar.</span>createPackageWithOptions
            <span class="apidocSignatureSpan">(src, dest, options, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.asar.extractAll">
            function <span class="apidocSignatureSpan">asar.</span>extractAll
            <span class="apidocSignatureSpan">(archive, dest)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.asar.extractFile">
            function <span class="apidocSignatureSpan">asar.</span>extractFile
            <span class="apidocSignatureSpan">(archive, filename)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.asar.listPackage">
            function <span class="apidocSignatureSpan">asar.</span>listPackage
            <span class="apidocSignatureSpan">(archive)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.asar.statFile">
            function <span class="apidocSignatureSpan">asar.</span>statFile
            <span class="apidocSignatureSpan">(archive, filename, followLinks)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">asar.</span>disk</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.asar.disk">module asar.disk</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.asar.disk.readArchiveHeaderSync">
            function <span class="apidocSignatureSpan">asar.disk.</span>readArchiveHeaderSync
            <span class="apidocSignatureSpan">(archive)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.asar.disk.readFileSync">
            function <span class="apidocSignatureSpan">asar.disk.</span>readFileSync
            <span class="apidocSignatureSpan">(filesystem, filename, info)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.asar.disk.readFilesystemSync">
            function <span class="apidocSignatureSpan">asar.disk.</span>readFilesystemSync
            <span class="apidocSignatureSpan">(archive)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.asar.disk.writeFilesystem">
            function <span class="apidocSignatureSpan">asar.disk.</span>writeFilesystem
            <span class="apidocSignatureSpan">(dest, filesystem, files, metadata, callback)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.asar" id="apidoc.module.asar">module asar</a></h1>


    <h2>
        <a href="#apidoc.element.asar.createPackage" id="apidoc.element.asar.createPackage">
        function <span class="apidocSignatureSpan">asar.</span>createPackage
        <span class="apidocSignatureSpan">(src, dest, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createPackage = function (src, dest, callback) {
  return module.exports.createPackageWithOptions(src, dest, {}, callback)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

```js
var asar = require('asar');

var src = 'some/path/';
var dest = 'name.asar';

asar.<span class="apidocCodeKeywordSpan">createPackage</span>(src, dest, function() {
  console.log('done.');
})
```

Please note that there is currently **no** error handling provided!

### Transform
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.asar.createPackageFromFiles" id="apidoc.element.asar.createPackageFromFiles">
        function <span class="apidocSignatureSpan">asar.</span>createPackageFromFiles
        <span class="apidocSignatureSpan">(src, dest, filenames, metadata, options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createPackageFromFiles = function (src, dest, filenames, metadata, options, callback) {
  if (typeof metadata === 'undefined' || metadata === null) { metadata = {} }
  const filesystem = new Filesystem(src)
  const files = []
  const unpackDirs = []

  let filenamesSorted = []
  if (options.ordering) {
    const orderingFiles = fs.readFileSync(options.ordering).toString().split('\n').map(function (line) {
      if (line.includes(':')) { line = line.split(':').pop() }
      line = line.trim()
      if (line.startsWith('/')) { line = line.slice(1) }
      return line
    })

    const ordering = []
    for (const file of orderingFiles) {
      const pathComponents = file.split(path.sep)
      let str = src
      for (const pathComponent of pathComponents) {
        str = path.join(str, pathComponent)
        ordering.push(str)
      }
    }

    let missing = 0
    const total = filenames.length

    for (const file of ordering) {
      if (!filenamesSorted.includes(file) &amp;&amp; filenames.includes(file)) {
        filenamesSorted.push(file)
      }
    }

    for (const file of filenames) {
      if (!filenamesSorted.includes(file)) {
        filenamesSorted.push(file)
        missing += 1
      }
    }

    console.log(`Ordering file has ${((total - missing) / total) * 100}% coverage.`)
  } else {
    filenamesSorted = filenames
  }

  const handleFile = function (filename, done) {
    let file = metadata[filename]
    let type
    if (!file) {
      const stat = fs.lstatSync(filename)
      if (stat.isDirectory()) { type = 'directory' }
      if (stat.isFile()) { type = 'file' }
      if (stat.isSymbolicLink()) { type = 'link' }
      file = {stat, type}
    }

    let shouldUnpack
    switch (file.type) {
      case 'directory':
        shouldUnpack = options.unpackDir
          ? isUnpackDir(path.relative(src, filename), options.unpackDir, unpackDirs)
          : false
        filesystem.insertDirectory(filename, shouldUnpack)
        break
      case 'file':
        shouldUnpack = false
        if (options.unpack) {
          shouldUnpack = minimatch(filename, options.unpack, {matchBase: true})
        }
        if (!shouldUnpack &amp;&amp; options.unpackDir) {
          const dirName = path.relative(src, path.dirname(filename))
          shouldUnpack = isUnpackDir(dirName, options.unpackDir, unpackDirs)
        }
        files.push({filename: filename, unpack: shouldUnpack})
        filesystem.insertFile(filename, shouldUnpack, file, options, done)
        return
      case 'link':
        filesystem.insertLink(filename, file.stat)
        break
    }
    return process.nextTick(done)
  }

  const insertsDone = function () {
    return mkdirp(path.dirname(dest), function (error) {
      if (error) { return callback(error) }
      return disk.writeFilesystem(dest, filesystem, files, metadata, function (error) {
        if (error) { return callback(error) }
        if (options.snapshot) {
          return createSnapshot(src, dest, filenames, metadata, options, callback)
        } else {
          return callback(null)
        }
      })
    })
  }

  const names = filenamesSorted.slice()

  const next = function (name) {
    if (!name) { return insertsDone() }

    return handleFile(name, function () {
      return next(names.shift())
    })
  }

  return next(names.shift())
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.asar.createPackageWithOptions" id="apidoc.element.asar.createPackageWithOptions">
        function <span class="apidocSignatureSpan">asar.</span>createPackageWithOptions
        <span class="apidocSignatureSpan">(src, dest, options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createPackageWithOptions = function (src, dest, options, callback) {
  const dot = typeof options.dot === 'undefined' ? true : options.dot

  return crawlFilesystem(src, { dot: dot }, function (error, filenames, metadata) {
    if (error) { return callback(error) }
    module.exports.createPackageFromFiles(src, dest, filenames, metadata, options, callback)
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var src = 'some/path/';
var dest = 'name.asar';

function transform(filename) {
  return new CustomTransformStream()
}

asar.<span class="apidocCodeKeywordSpan">createPackageWithOptions</span>(src, dest, { transform: transform }, function() {
  console.log('done.');
})
```

## Using with grunt

There is also an unofficial grunt plugin to generate asar archives at [bwin/grunt-asar][grunt-asar].
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.asar.extractAll" id="apidoc.element.asar.extractAll">
        function <span class="apidocSignatureSpan">asar.</span>extractAll
        <span class="apidocSignatureSpan">(archive, dest)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">extractAll = function (archive, dest) {
  const filesystem = disk.readFilesystemSync(archive)
  const filenames = filesystem.listFiles()

  // under windows just extract links as regular files
  const followLinks = process.platform === 'win32'

  // create destination directory
  mkdirp.sync(dest)

  return filenames.map((filename) =&gt; {
    filename = filename.substr(1)  // get rid of leading slash
    const destFilename = path.join(dest, filename)
    const file = filesystem.getFile(filename, followLinks)
    if (file.files) {
      // it's a directory, create it and continue with the next entry
      mkdirp.sync(destFilename)
    } else if (file.link) {
      // it's a symlink, create a symlink
      const linkSrcPath = path.dirname(path.join(dest, file.link))
      const linkDestPath = path.dirname(destFilename)
      const relativePath = path.relative(linkDestPath, linkSrcPath);
      // try to delete output file, because we can't overwrite a link
      (() =&gt; {
        try {
          fs.unlinkSync(destFilename)
        } catch (error) {}
      })()
      const linkTo = path.join(relativePath, path.basename(file.link))
      fs.symlinkSync(linkTo, destFilename)
    } else {
      // it's a file, extract it
      const content = disk.readFileSync(filesystem, filename, file)
      fs.writeFileSync(destFilename, content)
    }
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
                              asar.extractFile(archive, filename))
})

program.command('extract &lt;archive&gt; &lt;dest&gt;')
.alias('e')
.description('extract archive')
.action(function (archive, dest) {
  asar.<span class="apidocCodeKeywordSpan">extractAll</span>(archive, dest)
})

program.command('*')
.action(function (cmd) {
  console.log('asar: \'%s\' is not an asar command. See \'asar --help\'.', cmd)
})
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.asar.extractFile" id="apidoc.element.asar.extractFile">
        function <span class="apidocSignatureSpan">asar.</span>extractFile
        <span class="apidocSignatureSpan">(archive, filename)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">extractFile = function (archive, filename) {
  const filesystem = disk.readFilesystemSync(archive)
  return disk.readFileSync(filesystem, filename, filesystem.getFile(filename))
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
})

program.command('extract-file &lt;archive&gt; &lt;filename&gt;')
.alias('ef')
.description('extract one file from archive')
.action(function (archive, filename) {
  require('fs').writeFileSync(require('path').basename(filename),
                              asar.<span class="apidocCodeKeywordSpan">extractFile</span>(archive, filename))
})

program.command('extract &lt;archive&gt; &lt;dest&gt;')
.alias('e')
.description('extract archive')
.action(function (archive, dest) {
  asar.extractAll(archive, dest)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.asar.listPackage" id="apidoc.element.asar.listPackage">
        function <span class="apidocSignatureSpan">asar.</span>listPackage
        <span class="apidocSignatureSpan">(archive)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">listPackage = function (archive) {
  return disk.readFilesystemSync(archive).listFiles()
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  })
})

program.command('list &lt;archive&gt;')
.alias('l')
.description('list files of asar archive')
.action(function (archive) {
  var files = asar.<span class="apidocCodeKeywordSpan">listPackage</span>(archive)
  for (var i in files) {
    console.log(files[i])
  }
})

program.command('extract-file &lt;archive&gt; &lt;filename&gt;')
.alias('ef')
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.asar.statFile" id="apidoc.element.asar.statFile">
        function <span class="apidocSignatureSpan">asar.</span>statFile
        <span class="apidocSignatureSpan">(archive, filename, followLinks)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">statFile = function (archive, filename, followLinks) {
  const filesystem = disk.readFilesystemSync(archive)
  return filesystem.getFile(filename, followLinks)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.asar.disk" id="apidoc.module.asar.disk">module asar.disk</a></h1>


    <h2>
        <a href="#apidoc.element.asar.disk.readArchiveHeaderSync" id="apidoc.element.asar.disk.readArchiveHeaderSync">
        function <span class="apidocSignatureSpan">asar.disk.</span>readArchiveHeaderSync
        <span class="apidocSignatureSpan">(archive)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">readArchiveHeaderSync = function (archive) {
  const fd = fs.openSync(archive, 'r')
  let size
  let headerBuf
  try {
    const sizeBuf = new Buffer(8)
    if (fs.readSync(fd, sizeBuf, 0, 8, null) !== 8) {
      throw new Error('Unable to read header size')
    }

    const sizePickle = pickle.createFromBuffer(sizeBuf)
    size = sizePickle.createIterator().readUInt32()
    headerBuf = new Buffer(size)
    if (fs.readSync(fd, headerBuf, 0, size, null) !== size) {
      throw new Error('Unable to read header')
    }
  } finally {
    fs.closeSync(fd)
  }

  const headerPickle = pickle.createFromBuffer(headerBuf)
  const header = headerPickle.createIterator().readString()
  return {header: JSON.parse(header), headerSize: size}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  const headerPickle = pickle.createFromBuffer(headerBuf)
  const header = headerPickle.createIterator().readString()
  return {header: JSON.parse(header), headerSize: size}
}

module.exports.readFilesystemSync = function (archive) {
  if (!filesystemCache[archive]) {
    const header = this.<span class="apidocCodeKeywordSpan">readArchiveHeaderSync</span>(archive)
    const filesystem = new Filesystem(archive)
    filesystem.header = header.header
    filesystem.headerSize = header.headerSize
    filesystemCache[archive] = filesystem
  }
  return filesystemCache[archive]
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.asar.disk.readFileSync" id="apidoc.element.asar.disk.readFileSync">
        function <span class="apidocSignatureSpan">asar.disk.</span>readFileSync
        <span class="apidocSignatureSpan">(filesystem, filename, info)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">readFileSync = function (filesystem, filename, info) {
  let buffer = new Buffer(info.size)
  if (info.size &lt;= 0) { return buffer }
  if (info.unpacked) {
    // it's an unpacked file, copy it.
    buffer = fs.readFileSync(path.join(`${filesystem.src}.unpacked`, filename))
  } else {
    // Node throws an exception when reading 0 bytes into a 0-size buffer,
    // so we short-circuit the read in this case.
    const fd = fs.openSync(filesystem.src, 'r')
    try {
      const offset = 8 + filesystem.headerSize + parseInt(info.offset)
      fs.readSync(fd, buffer, 0, info.size, offset)
    } finally {
      fs.closeSync(fd)
    }
  }
  return buffer
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
const Filesystem = require('./filesystem')
const filesystemCache = {}

const copyFileToSync = function (dest, src, filename) {
const srcFile = path.join(src, filename)
const targetFile = path.join(dest, filename)

const content = fs.<span class="apidocCodeKeywordSpan">readFileSync</span>(srcFile)
const stats = fs.statSync(srcFile)
mkdirp.sync(path.dirname(targetFile))
return fs.writeFileSync(targetFile, content, {mode: stats.mode})
}

const writeFileListToStream = function (dest, filesystem, out, list, metadata, callback) {
if (list.length === 0) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.asar.disk.readFilesystemSync" id="apidoc.element.asar.disk.readFilesystemSync">
        function <span class="apidocSignatureSpan">asar.disk.</span>readFilesystemSync
        <span class="apidocSignatureSpan">(archive)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">readFilesystemSync = function (archive) {
  if (!filesystemCache[archive]) {
    const header = this.readArchiveHeaderSync(archive)
    const filesystem = new Filesystem(archive)
    filesystem.header = header.header
    filesystem.headerSize = header.headerSize
    filesystemCache[archive] = filesystem
  }
  return filesystemCache[archive]
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.asar.disk.writeFilesystem" id="apidoc.element.asar.disk.writeFilesystem">
        function <span class="apidocSignatureSpan">asar.disk.</span>writeFilesystem
        <span class="apidocSignatureSpan">(dest, filesystem, files, metadata, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">writeFilesystem = function (dest, filesystem, files, metadata, callback) {
  let sizeBuf
  let headerBuf
  try {
    const headerPickle = pickle.createEmpty()
    headerPickle.writeString(JSON.stringify(filesystem.header))
    headerBuf = headerPickle.toBuffer()

    const sizePickle = pickle.createEmpty()
    sizePickle.writeUInt32(headerBuf.length)
    sizeBuf = sizePickle.toBuffer()
  } catch (error) {
    return callback(error)
  }

  const out = fs.createWriteStream(dest)
  out.on('error', callback)
  out.write(sizeBuf)
  return out.write(headerBuf, function () {
    return writeFileListToStream(dest, filesystem, out, files, metadata, callback)
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>